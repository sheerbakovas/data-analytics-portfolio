# E-commerce Hourly Email Report

Проект по анализу данных и автоматизации отчётности.

В проекте используется датасет с clickstream-событиями и покупками интернет-магазина.  

Ссылка на датасет: https://www.kaggle.com/datasets/waqi786/e-commerce-clickstream-and-transaction-dataset

Задача — подготовить данные, рассчитать основные метрики и реализовать автоматическую отправку почасового отчёта на email.

---

## Что происходит в проекте

Сначала исходные данные очищаются и приводятся к удобному формату:

- время преобразуется в `datetime`,
- создаётся колонка с округлением до часа,
- выделяются покупки и выручка.

После подготовки данных при каждом запуске скрипта:

- определяется следующий час для обработки,
- рассчитываются метрики за этот час,
- формируется текст письма,
- отчёт отправляется на почту,
- в отдельном файле сохраняется информация о том, какой час уже был обработан.

Если за выбранный час нет событий, письмо всё равно отправляется с нулевыми значениями — это позволяет видеть, что пайплайн работает корректно.

---

## Рассчитываемые метрики

В отчёт входят базовые e-commerce показатели:

- количество событий,
- уникальные пользователи и сессии,
- количество покупок,
- выручка и средний чек,
- простая воронка: просмотр → добавление в корзину → покупка.

---

## Используемые технологии

- **Python**
- **Pandas** — обработка и агрегация данных
- **PyArrow** — сохранение данных в формате Parquet
- **Yagmail** — отправка писем через SMTP
- **python-dotenv** — работа с переменными окружения

---

## Как запустить

1. Установить зависимости из `requirements.txt`.
2. Поместить исходный датасет в папку `data/raw`.
3. Запустить `prepare_processed.py` для подготовки данных.
4. Настроить email в `.env`.
5. Запустить `run_hourly_report.py`.

Скрипт можно настроить на запуск каждый час через планировщик задач.
